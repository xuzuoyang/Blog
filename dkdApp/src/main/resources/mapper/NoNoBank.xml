<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dkd.framework.dao.NonoBankDao">
	<!-- 新增 -->
	<insert id="saveNonoBank" parameterType="com.dkd.framework.entity.NoNoBank" useGeneratedKeys="true" keyProperty="id" >
		INSERT INTO nonobank_data (
		projectNo,
		proDesc,
		totalMoney,
		yearRate,
		duteTime,
		danBao,
		shoukuanfangshi,
		loanStartTime,
		loanEndTime,
		huankuanqingkuang,
		toubiaojindu,
		xinyongdengji,
		gongjijieru,
		jiekuancishu,
		zhengchanghuanqing,
		yuqihuanqing,
		yuqiweihuan,
		daihuanbenjin,
		userId,
		userName,
		shenfen,
		xingbie,
		huji,
		nianling,
		suozaidi,
		school,
		zhuanye,
		ruxueTime,
		shourulaiyuan,
		jiatingnianshouru,
		yuejunshouru,
		biddingCount,
		pcId,
		mAvatarB,
		bo_all_repayed,
		bo_is_finish,
		createTime,
		updateTime,
		boExtno
		) 
		VALUES(
		#{projectNo},
		#{proDesc},
		#{totalMoney},
		#{yearRate},
		#{duteTime},
		#{danBao},
		#{shoukuanfangshi},
		#{loanStartTime},
		#{loanEndTime},
		#{huankuanqingkuang},
		#{toubiaojindu},
		#{xinyongdengji},
		#{gongjijieru},
		#{jiekuancishu},
		#{zhengchanghuanqing},
		#{yuqihuanqing},
		#{yuqiweihuan},
		#{daihuanbenjin},
		#{userId},
		#{userName},
		#{shenfen},
		#{xingbie},
		#{huji},
		#{nianling},
		#{suozaidi},
		#{school},
		#{zhuanye},
		#{ruxueTime},
		#{shourulaiyuan},
		#{jiatingnianshouru},
		#{yuejunshouru},
		#{biddingCount},
		#{pcId},
		#{mAvatarB},
		#{bo_all_repayed},
		#{bo_is_finish},
		#{createTime},
		#{updateTime},
		#{boExtno}
		)
	</insert>
	
	<!-- 动态sql查询 -->
	<select id="select" parameterType="map" resultType="com.dkd.framework.entity.NoNoBank">
		SELECT * FROM nonobank_data WHERE 1=1
		<if test="projectNo!=null">
		 and projectNo like "%"#{projectNo}"%"
		</if>
		and shenfen is  null
		limit #{pageIndex},#{pageSize}
	</select>
	
	
	<select id="selectByProjectNo" parameterType="map" resultType="com.dkd.framework.entity.NoNoBank">
		SELECT * FROM nonobank_data WHERE 1=1
		<if test="projectNo!=null">
		 and projectNo = #{projectNo}
		</if>
		<if test="userId!=null">
		 and userId = #{userId}
		</if>
	</select>
	<select id="selectCount" parameterType="map" resultType="long">
		SELECT count(*) FROM nonobank_data WHERE 1=1
		<if test="projectNo!=null">
		 and projectNo = #{projectNo}
		</if>
		<if test="userId!=null">
		 and userId = #{userId}
		</if>
	</select>

	<select id="selectUserId" parameterType="map" resultType="string">
		select * from (
		select userId from nonobank_data where shenfen is null and zhuanye is null
		group by userId having count(*)>=1
		) t limit #{pageIndex},#{pageSize}
		
		</select>
	
	<update id="update" parameterType="com.dkd.framework.entity.NoNoBank" >
		update nonobank_data
		set
		duteTime = #{duteTime},
		danBao = #{danBao},
		shoukuanfangshi = #{shoukuanfangshi},
		loanStartTime = #{loanStartTime},
		loanEndTime = #{loanEndTime},
		huankuanqingkuang = #{huankuanqingkuang},
		xinyongdengji = #{xinyongdengji},
		gongjijieru = #{gongjijieru},
		jiekuancishu = #{jiekuancishu},
		zhengchanghuanqing = #{zhengchanghuanqing},
		yuqihuanqing = #{yuqihuanqing},
		yuqiweihuan = #{yuqiweihuan},
		daihuanbenjin = #{daihuanbenjin},
		shenfen = #{shenfen},
		huji = #{huji},
		nianling = #{nianling},
		school = #{school},
		zhuanye = #{zhuanye},
		ruxueTime = #{ruxueTime},
		shourulaiyuan = #{shourulaiyuan},
		jiatingnianshouru = #{jiatingnianshouru},
		yuejunshouru = #{yuejunshouru},
		hunyin = #{hunyin},
		xueli = #{xueli},
		updateTime =#{updateTime},
		flag = #{flag}
		
		where
		id =#{id}
	</update>
</mapper>